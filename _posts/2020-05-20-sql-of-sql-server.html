---
layout: default
title: SQL Of SqlServer
---

<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>SQL Of SqlServer</title>
    <link href="/Media/style/main.css" rel="stylesheet" type="text/css">
</head>

<body>
    <h1>SQL Of SqlServer</h1>
    <p>记录一些常用的sql语句。</p>
    <h2>整表导入新表备份</h2>
    <p>要插入的表不能已存在。
    <pre>select * into DatabaseName.dbo.A_Backup from DatabaseName.dbo.A</pre>
    </p>
    <h2>一个表的数据导入另一张表</h2>
    <p>全部列数据。
    <pre>insert into DatabaseName_Backup.dbo.A_Backup select * from DatabaseName.dbo.A</pre>
    </p>
    <p>部分列数据。一些列需要根据限定条件设置默认值。
    <pre>insert into DatabaseName_Backup.dbo.A_Backup(Number) SELECT Number FROM DatabaseName.dbo.A</pre>
    </p>
    <h2>根据表的行数执行操作</h2>
    <p>
    <pre>BEGIN TRANSACTION;  
DECLARE @rowCounter integer
SELECT @rowCounter = COUNT(1) FROM DatabaseName.dbo.A_Backup
PRINT @rowCounter
IF @rowCounter > 0
BEGIN
	PRINT 'ROLLBACK';
	ROLLBACK TRANSACTION;
END
ELSE
BEGIN
	PRINT 'COMMIT'
	COMMIT TRANSACTION
END</pre>
    </p>
    <h2>不执行后面SQL语句</h2>
    <p>
    <pre>RETURN</pre>
    </p>
    <h2>获取表的所有列名</h2>
    <p>
    <pre>SELECT * FROM sys.columns WHERE object_id=object_id('DatabaseName.dbo.A')</pre>
    </p>

</body>

</html>